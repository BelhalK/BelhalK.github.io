<!DOCTYPE html>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>
         Belhal Karimi &middot; blog
      </title>
      <link rel="stylesheet" href="../css/styles.css">
      <link rel="alternate" type="application/atom+xml" title="Belhal Karimi" href="/atom.xml">
   </head>
   <body>
      <div class="container content">
         <header class="masthead">
            <h3 class="masthead-title">
               <a href="../blogindex.html" title="Home">Belhal Karimi</a>
               <small>blog</small>
            </h3>
         </header>
         <main>
            <div class="posts">
               <article class="post">
                  <h1 class="post-title">
                     <a href="">
                     Label Mixup vs Loss Mixup
                     </a>
                  </h1>
                  <time datetime="2020-09-27T00:00:00+00:00" class="post-date">27 Sep 2020</time>
                  <p class="message">
                     Instead of mixing the labels as in classical mixup, mixing the losses might be more sensible for certain applications like speech enhancement.
                  </p>
                  <h3 id="mixup">Mixup</h3>
                  <p>Minimizing a loss function on examples in the training set, also known as Empirical Risk Minimization (ERM), is the long established learning paradigm for supervised learning. Departing from tradition, <a href="https://openreview.net/pdf?id=r1Ddp1-Rb">mixup</a> is a novel paradigm that proposes to train deep networks on virtual examples randomly sampled from the space of convex combinations of a pair of labeled examples.</p>
                  <p>For random \(x_1,x_2\in\mathcal{X},y_1,y_2\in\mathcal{Y},\lambda\in[0,1]\), mixup creates the virtual example \((\lambda x_1 + (1-\lambda)x_2, \lambda y_1 + (1-\lambda)y_2)\) for training. Below, we show an interpolation of a cat and a dog image, credits to <a href="https://hoya012.github.io/blog/Bag-of-Tricks-for-Image-Classification-with-Convolutional-Neural-Networks-Review/">https://hoya012.github.io/blog/Bag-of-Tricks-for-Image-Classification-with-Convolutional-Neural-Networks-Review/</a>.</p>
                  <p><img src="/images/2020-09-27-revisiting-mixup/classical_mixup.png" alt="" /></p>
                  <h3 id="applying-mixup-beyond-classification">Applying Mixup Beyond Classification</h3>
                  <p>Mixup has been shown to boost generalization and calibration when used to train deep networks on classification tasks. However, it is not clear how to generalize it to tasks beyond classification.</p>
                  <p>Here are two possibilities:</p>
                  <p>1) Label mixup: \(\mathcal{L}(\hat{y}, \lambda y_1 + (1-\lambda) y_2)\)</p>
                  <p>2) Loss mixup: \(\lambda \mathcal{L}(\hat{y}, y_1) + (1-\lambda) \mathcal{L}(\hat{y}, y_2)\)</p>
                  <p>Mixing the labels seems like the obvious way, since this is how mixup was originally formulated. But it turns out that mixing the losses is also a valid generalization, because it is equivalent to mixing the losses for classification tasks.</p>
                  <p><img src="/images/2020-09-27-revisiting-mixup/theorem.png" alt="" /></p>
                  <p>The theorem implies that label and loss mixup are equivalent for the cross-entropy and mean squared error losses, which are most commonly used respectively in classification and regression.</p>
                  <h3 id="example-of-speech-enhancement">Example of Speech Enhancement</h3>
                  <p>In general, however, the two mixups have very different effects. For a task like speech enhancement, where we train a network to map from a noisy speech sample to a clean one, the two versions of mixup lead to two vastly different interpretations.</p>
                  <p>Label mixup results in training against a noisy target, since the mix of two clean samples becomes a noisy one. By contrast, loss mixup results in an implicit solution of the cocktail party problem, where we train a network to extract each individual clean signal from a mix of two noisy samples.</p>
                  <p>Indeed, our experimental results reveal that loss mixup leads to superior performance compared to ERM, but not label mixup.</p>
                  <p>Thus, when applying mixup to non-classification tasks, it helps to think carefully about the qualitative difference between label and loss mixup before choosing the appropriate one.</p>
                  <p>For more insights about mixup (for example, using the reparametrization trick to tune the mixing distribution), please check out our <a href="https://zenodo.org/record/4053951">paper</a>.</p>
               </article>
            </div>
            <div class="pagination">
               <a class="pagination-item older" href="./kmean.html">Older</a>
               <span class="pagination-item newer">Newer</span>
            </div>
            <div class="footer">
               <br />
               <small>
               Read <a href="../blogindex.html">more</a>  |
               About <a target = "_blank" href="https://belhal.github.io/">me</a>
               </small>
            </div>
         </main>
      </div>
   </body>
</html>